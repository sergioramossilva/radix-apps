version: 2
jobs:
  build:
    docker:
      - image: circleci/node:latest
    steps:
      - checkout
      - run:
          name: Build APT Repository
          command: |
            wget https://gist.githubusercontent.com/rauldipeas/4c718477023baee2448083b4de263187/raw/31e4617d811369972150226e31bcd6ca4ba71662/rauldipeas_pub.gpg
            wget https://gist.githubusercontent.com/rauldipeas/4c718477023baee2448083b4de263187/raw/31e4617d811369972150226e31bcd6ca4ba71662/rauldipeas_sec.gpg
            gpg --import rauldipeas_pub.gpg
            gpg --allow-secret-key-import --import rauldipeas_sec.gpg
            bash repo/update-repo.sh
      - run:
          name: Install netlify-cli
          command: sudo npm install -g --silent netlify-cli
      - run:
          name: Deploy to Netlify
          command: netlify deploy --dir=website -p
